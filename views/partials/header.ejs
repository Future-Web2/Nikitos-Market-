<header>
    <div class="container navbar">
        <a href="/" class="logo">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="32" height="32" rx="6" fill="#0F172A" />
                <path d="M8 22V10L13.5 16L19 10V22M24 10V22" stroke="white" stroke-width="2.5" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
            Nikita<span>Market</span>
        </a>

        <form action="/search" method="GET" class="search-bar">
            <input type="text" name="q" class="search-input" placeholder="Поиск товаров, брендов и категорий..."
                value="<%= typeof query !== 'undefined' ? query : '' %>">
            <button type="submit" class="search-btn">Найти</button>
        </form>

        <div class="user-actions">
            <a href="/shop"
                class="<%= (typeof query !== 'undefined' && query === null) ? 'active-link' : '' %>">Каталог</a>
            <% if (user) { %>
                <div style="display: flex; flex-direction: column; line-height: 1.2; text-align: right;">
                    <span style="font-size: 0.75rem; color: #64748b;">Вы вошли как</span>
                    <span style="font-weight: 700; color: #0f172a;">
                        <%= user.username %>
                    </span>
                </div>
                <a href="/logout" style="color: #ef4444; font-size: 0.9rem;">Выйти</a>
                <% } else { %>
                    <a href="/login">Войти</a>
                    <a href="/register" class="btn-primary"
                        style="color: white !important; padding: 0.5rem 1rem; border-radius: 4px; text-decoration: none;">Регистрация</a>
                    <% } %>
                        <a href="/cart" style="position: relative; display: flex; align-items: center;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                style="color: var(--text-color);">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                            </svg>
                            <% if (cartCount> 0) { %>
                                <span
                                    style="position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; border-radius: 50%; width: 18px; height: 18px; font-size: 11px; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                                    <%= cartCount %>
                                </span>
                                <% } %>
                        </a>
        </div>
    </div>
</header>